<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>

    <style type="text/css">
        * {
            padding: 0;
            margin: 0;
            list-style: none;
            border: 0;
        }

        .all {
            width: 500px;
            height: 200px;
            padding: 7px;
            border: 1px solid #ccc;
            margin: 100px auto;
            position: relative;
        }

        .screen {
            width: 500px;
            height: 200px;
            overflow: hidden;
            position: relative;
        }

        .screen li {
            width: 500px;
            height: 200px;
            overflow: hidden;
            float: left;
        }

        .screen ul {
            position: absolute;
            left: 0;
            top: 0;
            width: 3000px;
        }

        .all ol {
            position: absolute;
            right: 10px;
            bottom: 10px;
            line-height: 20px;
            text-align: center;
        }

        .all ol li {
            float: left;
            width: 20px;
            height: 20px;
            background: #fff;
            border: 1px solid #ccc;
            margin-left: 10px;
            cursor: pointer;
        }

        .all ol li.current {
            background: #DB192A;
        }

        #arr {
            display: none;
        }

        #arr span {
            width: 40px;
            height: 40px;
            position: absolute;
            left: 5px;
            top: 50%;
            margin-top: -20px;
            background: #000;
            cursor: pointer;
            line-height: 40px;
            text-align: center;
            font-weight: bold;
            font-size: 30px;
            color: #fff;
            opacity: 0.3;
            border: 1px solid #fff;
        }

        #arr #right {
            right: 5px;
            left: auto;
        }
    </style>


</head>
<body>


<div class="all" id='box'>

    <div class="screen"><!--相框-->

        <ul>
            <li><img src="../images/1.jpg" width="500" height="200" alt="img"/></li>
            <li><img src="../images/2.jpg" width="500" height="200" alt="img"/></li>
            <li><img src="../images/3.jpg" width="500" height="200" alt="img"/></li>
            <li><img src="../images/4.jpg" width="500" height="200" alt="img"/></li>
            <li><img src="../images/5.jpg" width="500" height="200" alt="img"/></li>
        </ul>
        <ol>
        </ol>
    </div>

    <div id="arr">
        <span id="left">&lt;</span><span id="right">&gt;</span>
    </div>

</div>


<script>

    function animate(element, target) {

        //确保点击多次，只生成一个计时器
        clearInterval(element.timeId);

        //增加自定义 timeId 属性
        element.timeId = setInterval(function () {

            //获取当前 div 的位置
            var current = element.offsetLeft;

            //每次移动的距离
            var step = 10;

            //判断向前向后走
            step = current < target ? step : -step;

            current += step;

            //如果目标位置 减去 已经走的步数 小于 每次走的步数，那么就继续走
            //Math.abs(); 取绝对值
            if (Math.abs(target - current) > Math.abs(step)) {

                element.style.left = current + 'px';

            } else {

                clearInterval(element.timeId);

                element.style.left = target + 'px';
            }
        }, 20);
    }


    function my$(ele) {

        return document.getElementById(ele);
    }


    //获取最外面的 div
    var box = my$('box');

    //获取相框
    var screen = box.children[0];

    //获取相框宽度
    var imgWidth = screen.offsetWidth;

    //获取 ul
    var ulObj = screen.children[0];

    //获取 ul 中的所有 li
    var list = ulObj.children;

    //获取 ol
    var olObj = screen.children[1];

    //焦点 div
    var arr = my$('arr');

    //需要全局中访问
    var index = 0;


    //创建小按钮( 根据 ul 中 li 的个数 )
    for (var i = 0; i < list.length; i++) {

        //创建 li 标签
        var liObj = document.createElement('li');

        //追加到 ol 标签中
        olObj.appendChild(liObj);

        liObj.innerHTML = (i + 1);


        //在每个 ol 中的 li 标签上添加一个自定义属性，记录 索引
        liObj.setAttribute('index', i);

        //注册鼠标进入事件
        liObj.onmouseover = function () {

            //去除所有 li 的背景
            for (var j = 0; j < olObj.children.length; j++) {

                olObj.children[j].removeAttribute('class');
            }

            //为当前 li 进入时设置 背景颜色
            this.className = 'current';

            //获取鼠标进入的 li 的当前索引值
            index = this.getAttribute('index');

            animate(ulObj, -index * imgWidth);
        };
    }

    //设置默认 选中 背景
    olObj.children[0].className = 'current';

    //克隆第一个 ul 中第一个 li，加入到 ul 中的最后
    ulObj.appendChild(list[0].cloneNode(true));



    //设置自动轮播事件( 调用右侧按钮点击事件 )
    var timeId = setInterval(clickHandle, 2000);



    //鼠标进入到 box 的 div 显示左右焦点的 div
    box.onmouseover = function () {

        arr.style.display = "block";

        //鼠标进入清除计时器
        clearInterval(timeId);
    };


    //鼠标进入到 box 的 div 隐藏左右焦点的 div
    box.onmouseout = function () {

        arr.style.display = "none";

        //鼠标离开创建计时器
        timeId = setInterval(clickHandle, 2000);
    };


    //右边按钮
    my$('right').onclick = clickHandle;

    function clickHandle() {

        if (index == list.length - 1) {

            index = 0;

            ulObj.style.left = 0;
        }

        index++;

        animate(ulObj, -index * imgWidth);

        //如果 index == 5 说明，此时显示 第 6 个图( 内容试试第一张图片 )，第一个小按钮有颜色
        if (index == list.length - 1) {

            //设置最后一个元素 的属性无
            olObj.children[olObj.children.length - 1].className = "";
            //设置第一个元素 属性有
            olObj.children[0].className = 'current';

        } else {

            for (var i = 0; i < olObj.children.length; i++) {

                //去除所有小按钮的背景颜色
                olObj.children[i].removeAttribute('class');
            }

            //设置当前小按钮的背景颜色
            olObj.children[index].className = 'current';
        }
    }


    //左边按钮
    my$('left').onclick = function () {

        if (index == 0) {

            index = 5;

            ulObj.style.left = -index * imgWidth + "px";
        }

        index--;

        animate(ulObj, -index * imgWidth);

        for (var i = 0; i < olObj.children.length; i++) {

            olObj.children[i].removeAttribute('class');
        }

        olObj.children[index].className = 'current';

    };


</script>


</body>
</html>
